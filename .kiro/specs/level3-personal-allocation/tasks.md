# 第三级个人分配功能 - 实现任务列表

## 已完成

- [x] 1. 创建需求文档
- [x] 2. 创建设计文档
- [x] 3. 创建后端API路由 (`server/routes/personal-allocation.js`)
- [x] 4. 在服务器主文件中注册路由

## 待完成

- [ ] 5. 前端：添加第三级加载逻辑
  - 在 `loadProjectDetail()` 中调用 `loadLevel3()`
  - 实现 `loadLevel3()` 函数
  - 根据用户角色显示不同内容

- [ ] 6. 前端：实现个人分配显示
  - 实现 `displayLevel3()` 函数
  - 显示部门分配总额、已分配、剩余金额
  - 显示参与人员列表
  - 添加"分配参与人员"按钮

- [ ] 7. 前端：创建个人分配模态框
  - 添加模态框HTML结构
  - 添加模态框样式
  - 实现打开/关闭模态框函数

- [ ] 8. 前端：实现员工选择功能
  - 加载本部门员工列表
  - 实现员工多选
  - 显示已选员工

- [ ] 9. 前端：实现金额输入和验证
  - 为每个员工添加金额输入框
  - 实时计算总额和剩余金额
  - 验证金额有效性
  - 显示超额警告

- [ ] 10. 前端：实现保存功能
  - 收集所有分配数据
  - 调用保存API
  - 处理成功/失败响应
  - 刷新显示

- [ ] 11. 前端：实现删除功能
  - 添加删除按钮
  - 确认删除操作
  - 调用删除API
  - 更新显示

- [ ] 12. 测试：完整流程测试
  - 测试管理员查看所有部门
  - 测试部门经理只能看本部门
  - 测试金额验证
  - 测试超额限制
  - 测试保存和删除

- [ ] 13. 优化：用户体验改进
  - 添加加载状态
  - 优化错误提示
  - 添加成功提示
  - 优化界面布局

## 当前进度

后端API已完成，正在实现前端功能。

## 下一步

实现任务5：在项目详情页添加第三级加载逻辑
