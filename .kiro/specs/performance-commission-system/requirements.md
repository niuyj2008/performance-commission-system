# 需求文档

## 简介

本系统是为建筑设计公司开发的绩效提成分配管理系统。系统用于计算和管理设计师的项目提成，支持基于建筑属性的提成总额计算、基于空调面积表的部门间分配、以及部门内部的灵活分配。系统将部署在字节扣子平台上，供公司内部使用。

## 术语表

- **系统**：绩效提成分配管理系统
- **用户**：使用系统的人员，包括总经理、财务人员、部门经理
- **项目**：建筑设计项目，包含项目名称、设计阶段、建筑属性等信息
- **建筑属性**：项目的建筑特征，如面积、类型等，用于计算提成总额
- **空调面积表**：记录项目中不同空调形式对应面积的表格，用于部门间提成分配
- **提成总额**：根据项目建筑属性计算出的总提成金额
- **部门分配比例**：基于空调面积表计算的各部门提成占比
- **部门内分配**：部门经理在部门内部对提成的分配
- **项目追加**：项目在原有基础上的追加内容，需重新计算提成
- **发放记录**：提成的发放历史记录
- **计算周期**：提成计算的时间周期，通常为半年

## 需求

### 需求 1：用户认证与权限管理

**用户故事：** 作为系统管理员，我希望不同角色的用户有不同的访问权限，以便保护敏感的财务数据。

#### 验收标准

1. WHEN 用户登录系统 THEN 系统 SHALL 验证用户身份并分配相应角色
2. WHEN 总经理或财务人员访问数据 THEN 系统 SHALL 显示所有部门和项目的完整数据
3. WHEN 部门经理访问数据 THEN 系统 SHALL 仅显示该部门经理所属部门的数据
4. WHEN 用户尝试访问无权限的数据 THEN 系统 SHALL 拒绝访问并提示权限不足

### 需求 2：项目信息管理

**用户故事：** 作为财务人员，我希望能够录入和管理项目信息，以便为提成计算提供基础数据。

#### 验收标准

1. WHEN 财务人员录入新项目 THEN 系统 SHALL 保存项目名称、编号、设计阶段、建筑属性等信息
2. WHEN 财务人员修改项目信息 THEN 系统 SHALL 更新项目数据并保留修改历史
3. WHEN 财务人员查询项目 THEN 系统 SHALL 显示项目的完整信息和当前状态
4. WHEN 项目有追加内容 THEN 系统 SHALL 记录追加信息并标记为需要重新计算

### 需求 3：基于建筑属性的提成总额计算

**用户故事：** 作为财务人员，我希望系统能够根据建筑属性自动计算项目的提成总额，以便减少手工计算错误。

#### 验收标准

1. WHEN 财务人员导入或配置计算公式 THEN 系统 SHALL 保存建筑属性与提成总额的计算规则
2. WHEN 系统计算项目提成总额 THEN 系统 SHALL 根据项目的建筑属性应用相应的计算公式
3. WHEN 项目建筑属性发生变化 THEN 系统 SHALL 重新计算提成总额
4. WHEN 计算完成 THEN 系统 SHALL 显示提成总额及计算依据

### 需求 4：空调面积表管理

**用户故事：** 作为财务人员，我希望能够为每个项目维护空调面积表，以便计算各部门的提成分配比例。

#### 验收标准

1. WHEN 财务人员为项目录入空调面积表 THEN 系统 SHALL 保存不同空调形式及对应的面积数据
2. WHEN 财务人员修改空调面积表 THEN 系统 SHALL 更新数据并保留修改历史
3. WHEN 财务人员查询空调面积表 THEN 系统 SHALL 显示项目的完整空调面积分布
4. WHEN 空调面积表数据不完整 THEN 系统 SHALL 提示用户补充必要信息

### 需求 5：基于空调面积表的部门分配比例计算

**用户故事：** 作为财务人员，我希望系统能够根据空调面积表自动计算各部门的提成分配比例，以便公平分配项目提成。

#### 验收标准

1. WHEN 财务人员导入或配置分配规则 THEN 系统 SHALL 保存空调面积与部门分配比例的计算公式
2. WHEN 系统计算部门分配比例 THEN 系统 SHALL 根据项目空调面积表应用相应的计算规则
3. WHEN 空调面积表发生变化 THEN 系统 SHALL 重新计算各部门的分配比例
4. WHEN 计算完成 THEN 系统 SHALL 显示各部门的分配比例及计算依据
5. WHEN 所有部门分配比例相加 THEN 系统 SHALL 确保总和等于100%

### 需求 6：部门内部提成分配

**用户故事：** 作为部门经理，我希望能够灵活分配本部门的项目提成给部门成员，以便根据实际贡献进行奖励。

#### 验收标准

1. WHEN 部门经理查看部门提成 THEN 系统 SHALL 显示本部门在各项目中的提成金额
2. WHEN 部门经理分配提成给成员 THEN 系统 SHALL 记录每个成员的分配金额和分配比例
3. WHEN 部门经理修改分配方案 THEN 系统 SHALL 更新分配数据并保留修改历史
4. WHEN 部门内所有成员分配金额相加 THEN 系统 SHALL 确保总和不超过部门可分配提成总额
5. WHEN 分配方案保存 THEN 系统 SHALL 验证分配数据的完整性和准确性

### 需求 7：项目追加处理

**用户故事：** 作为财务人员，我希望系统能够处理项目追加情况，以便在原有基础上重新计算提成。

#### 验收标准

1. WHEN 财务人员标记项目有追加 THEN 系统 SHALL 记录追加的建筑属性和空调面积变化
2. WHEN 系统重新计算追加项目提成 THEN 系统 SHALL 基于追加后的总量计算新的提成总额
3. WHEN 系统计算追加部分提成 THEN 系统 SHALL 扣除已发放的提成金额
4. WHEN 追加计算完成 THEN 系统 SHALL 显示追加前后的提成对比和本次应发金额
5. WHEN 追加项目有多次追加 THEN 系统 SHALL 累计记录所有追加和发放历史

### 需求 8：提成发放记录管理

**用户故事：** 作为财务人员，我希望系统能够记录提成的发放历史，以便追踪和审计。

#### 验收标准

1. WHEN 财务人员记录提成发放 THEN 系统 SHALL 保存发放日期、发放金额、发放对象等信息
2. WHEN 财务人员查询发放记录 THEN 系统 SHALL 显示指定时间范围内的发放历史
3. WHEN 项目有多次发放 THEN 系统 SHALL 累计显示该项目的总发放金额和剩余金额
4. WHEN 发放记录保存 THEN 系统 SHALL 更新项目和人员的发放状态

### 需求 9：半年度提成汇总

**用户故事：** 作为财务人员，我希望系统能够按半年度汇总提成数据，以便进行周期性的提成结算。

#### 验收标准

1. WHEN 财务人员选择计算周期 THEN 系统 SHALL 筛选该周期内的所有项目
2. WHEN 系统生成半年度汇总 THEN 系统 SHALL 计算每个部门和每个人员在该周期的提成总额
3. WHEN 汇总包含多个项目 THEN 系统 SHALL 分项列出每个项目的提成明细
4. WHEN 汇总完成 THEN 系统 SHALL 生成可导出的汇总报表

### 需求 10：Excel数据导入导出

**用户故事：** 作为财务人员，我希望能够导入和导出Excel数据，以便与现有工作流程兼容。

#### 验收标准

1. WHEN 财务人员导入Excel项目清单 THEN 系统 SHALL 解析并保存项目基本信息
2. WHEN 财务人员导入Excel空调面积表 THEN 系统 SHALL 解析并关联到对应项目
3. WHEN 财务人员导出提成数据 THEN 系统 SHALL 生成包含完整计算结果的Excel文件
4. WHEN 导入数据格式错误 THEN 系统 SHALL 提示具体的错误信息和位置
5. WHEN 导出数据 THEN 系统 SHALL 保持与原有Excel模板相似的格式和结构

### 需求 11：计算公式配置管理

**用户故事：** 作为系统管理员，我希望能够配置和管理计算公式，以便适应公司政策的变化。

#### 验收标准

1. WHEN 管理员配置建筑属性计算公式 THEN 系统 SHALL 保存公式并应用于后续计算
2. WHEN 管理员配置部门分配规则 THEN 系统 SHALL 保存规则并应用于后续分配
3. WHEN 管理员修改计算公式 THEN 系统 SHALL 记录修改历史并标记受影响的项目
4. WHEN 管理员查看公式配置 THEN 系统 SHALL 显示当前生效的所有计算规则
5. WHEN 公式配置变更 THEN 系统 SHALL 提示用户是否重新计算已有项目

### 需求 12：数据查询和报表

**用户故事：** 作为用户，我希望能够查询和查看各类提成数据报表，以便了解提成分配情况。

#### 验收标准

1. WHEN 用户查询个人提成 THEN 系统 SHALL 显示该人员在各项目中的提成明细和总额
2. WHEN 部门经理查询部门提成 THEN 系统 SHALL 显示本部门的项目提成汇总和成员分配情况
3. WHEN 总经理或财务查询全局数据 THEN 系统 SHALL 显示所有部门和项目的提成统计
4. WHEN 用户筛选时间范围 THEN 系统 SHALL 显示指定时间段内的提成数据
5. WHEN 用户导出报表 THEN 系统 SHALL 生成包含查询结果的Excel或PDF文件
